#!name = 自动加入TestFlight
#!desc = 自动监控TestFlight名额，一旦有新的名额即刻加入。
#!openUrl = https://apps.apple.com/app/id899247664
#!author = DecoAri[https://github.com/DecoAri], xream[https://github.com/xream]
#!tag = 定时任务
#!system = 
#!system_version = 
#!loon_version = 3.2.1(749)
#!homepage = https://github.com/luestr/ProxyResource/blob/main/README.md
#!icon = https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/TestFlight.png
#!input = APP_ID
#!date = 2024-10-22 00:22:37

[Argument]
CaptureAccountToken = switch, false, true, tag = 捕获账号令牌, desc = 此开关控制插件是否捕获账户令牌
CaptureAppID = switch, false, true, tag = 捕获应用ID, desc = 此开关控制插件是否捕获应用ID
TimingParameters = input, "*/1 * * * * *", tag = 定时参数, desc = 这里需要输入符合CRON表达式的参数

[Rule]
DOMAIN, testflight.apple.com, PROXY

[Script]
http-request ^https?:\/\/testflight\.apple\.com\/v3\/accounts\/.*\/apps$ script-path = https://raw.githubusercontent.com/jqyisbest/LoonKissSurge/refs/heads/main/Scripts/1585ae1b6cdf0adf97222c8bcb967458ef79f484248fc626e98c65c5f91f1787.js, tag = 获取账号令牌, enable={CaptureAccountToken}

http-request ^https://testflight.apple.com/join/(.*) script-path = https://raw.githubusercontent.com/jqyisbest/LoonKissSurge/refs/heads/main/Scripts/1585ae1b6cdf0adf97222c8bcb967458ef79f484248fc626e98c65c5f91f1787.js, tag = 应用ID捕获, enable={CaptureAppID}

cron {TimingParameters} script-path = https://raw.githubusercontent.com/jqyisbest/LoonKissSurge/refs/heads/main/Scripts/bcfe992065166561070e5d1623d187213187453933dd7f7f7efda9d449c4fc4b.js, tag = 自动加入TF, timeout = 180

[MitM]
hostname = testflight.apple.com